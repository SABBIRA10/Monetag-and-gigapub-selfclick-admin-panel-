<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>TAKA GHOR - Admin Panel</title>
  <style>
    :root{
      --bg: #0f1420; --panel: #141b2b; --text: #e7f0ff; --muted: #95a3bf;
      --primary: #20c997; --primary-2: #ff7a18; --btn: #1f2a44; --success: #22c55e;
      --danger: #ef4444; --radius: 16px; --shadow: 0 10px 20px rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto;
      background: linear-gradient(135deg, #0b1220, #0f1a2e 60%, #07101f);
      color:var(--text); min-height:100svh; padding:18px;
    }
    .container{max-width:800px; margin:0 auto;}
    .header{
      padding:18px 16px; background:linear-gradient(90deg, #1dd1a1, #ff7a18);
      color:#0b1020; font-weight:800; font-size:20px; text-align: center;
      border-radius: var(--radius); margin-bottom: 20px;
    }
    .sub{font-size:12px; font-weight:600; opacity:.85; text-align: center;}
    .card{
      background:#0f1729; border:1px solid rgba(255,255,255,.06);
      border-radius:var(--radius); padding:20px; box-shadow:var(--shadow);
      margin-bottom: 20px;
    }
    .card-title{
      font-size: 18px; font-weight: 700; margin-bottom: 15px;
      color: var(--primary); text-align: center;
    }
    .form-group{margin-bottom: 15px;}
    .form-label{display: block; margin-bottom: 5px; font-size: 14px; color: var(--muted);}
    .form-input{
      width: 100%; padding: 12px 14px; border-radius: 12px; background: #0a1120;
      border: 1px solid rgba(255,255,255,0.1); color: var(--text); font-family: inherit;
    }
    .btn{
      padding:14px 16px; border-radius:16px; border:none; font-weight:800;
      cursor:pointer; display:flex; align-items:center; justify-content:center; gap:10px;
      transition:.15s transform ease; box-shadow:var(--shadow); width: 100%; margin-top: 10px;
    }
    .btn:active{transform:scale(0.98)}
    .btn-primary{background:linear-gradient(90deg,#1dd1a1,#20c997); color:#052018}
    .btn-danger{background:linear-gradient(90deg,#ef4444,#f97316); color:#2b0a0a}
    .btn-warn{background:linear-gradient(90deg,#ff7a18,#ffb703); color:#2b1700}
    .stats-container{display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;}
    .stat-box{background: #0c1322; border-radius: 12px; padding: 15px; text-align: center;}
    .stat-value{font-size: 24px; font-weight: 800; margin: 5px 0;}
    .stat-label{font-size: 12px; color: var(--muted);}
    .admin-actions{display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;}
    .success-msg{
      background: rgba(34, 197, 94, 0.2); border: 1px solid rgba(34, 197, 94, 0.3);
      color: #22c55e; padding: 10px; border-radius: 8px; margin-top: 10px; display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      TAKA GHOR - Admin Panel
      <div class="sub">Developer by MD SABBIR</div>
    </header>

    <div class="card">
      <div class="card-title">Ad Configuration</div>
      <div class="form-group">
        <label class="form-label">Monetag Ad ID / Zone ID</label>
        <input type="text" class="form-input" id="monetagId" placeholder="Enter Monetag Zone ID">
      </div>
      <div class="form-group">
        <label class="form-label">Gigapub Ad ID / Zone ID</label>
        <input type="text" class="form-input" id="gigapubId" placeholder="Enter Gigapub ID">
      </div>
      <button class="btn btn-primary" id="saveAdIds">Save Ad IDs</button>
      <div class="success-msg" id="adSuccessMsg">Ad IDs saved successfully!</div>
    </div>

    <div class="card">
      <div class="card-title">User Statistics</div>
      <div class="stats-container">
        <div class="stat-box">
          <div class="stat-label">Total Users</div>
          <div class="stat-value" id="totalUsers">0</div>
        </div>
        <div class="stat-box">
          <div class="stat-label">Active Today</div>
          <div class="stat-value" id="activeToday">N/A</div>
        </div>
        <div class="stat-box">
          <div class="stat-label">Total Ads Watched</div>
          <div class="stat-value" id="totalAds">0</div>
        </div>
        <div class="stat-box">
          <div class="stat-label">Total Points Earned</div>
          <div class="stat-value" id="totalPoints">0.00</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">Admin Actions</div>
      <div class="admin-actions">
        <div>
          <button class="btn btn-danger" id="resetBalances">Reset All Balances</button>
        </div>
        <div>
          <button class="btn btn-warn" id="resetAdCounts">Reset All Ad Counts</button>
        </div>
      </div>
      <div class="success-msg" id="resetSuccessMsg">Reset operation completed successfully!</div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

  <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyC3jGCEeXIJYmwx-l-hUBhBPDpJyDHAdn0",
      authDomain: "monetag-self-click.firebaseapp.com",
      databaseURL: "https://monetag-self-click-default-rtdb.firebaseio.com",
      projectId: "monetag-self-click",
      storageBucket: "monetag-self-click.firebasestorage.app",
      messagingSenderId: "496756377613",
      appId: "1:496756377613:web:313eabaf1ed0458af8ed44",
      measurementId: "G-4X71FXFVCR"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // DOM elements
    const monetagIdInput = document.getElementById('monetagId');
    const gigapubIdInput = document.getElementById('gigapubId');
    const saveAdIdsBtn = document.getElementById('saveAdIds');
    const resetBalancesBtn = document.getElementById('resetBalances');
    const resetAdCountsBtn = document.getElementById('resetAdCounts');
    const adSuccessMsg = document.getElementById('adSuccessMsg');
    const resetSuccessMsg = document.getElementById('resetSuccessMsg');

    // Load and display stats
    function loadStats() {
      database.ref('stats').on('value', (snapshot) => {
        const stats = snapshot.val() || {};
        document.getElementById('totalUsers').textContent = stats.totalUsers || 0;
        document.getElementById('totalAds').textContent = stats.totalAdsWatched || 0;
        document.getElementById('totalPoints').textContent = (stats.totalPointsEarned || 0).toFixed(2);
      });
    }

    // Load saved ad IDs
    function loadAdIds() {
      database.ref('config').once('value', (snapshot) => {
        const config = snapshot.val() || {};
        monetagIdInput.value = config.monetagAdId || '';
        gigapubIdInput.value = config.gigapubAdId || '';
      });
    }

    // Save ad IDs to Firebase
    function saveAdIds() {
      const monetagId = monetagIdInput.value.trim();
      const gigapubId = gigapubIdInput.value.trim();
      
      database.ref('config').set({
        monetagAdId: monetagId,
        gigapubAdId: gigapubId
      }).then(() => {
        adSuccessMsg.style.display = 'block';
        setTimeout(() => adSuccessMsg.style.display = 'none', 3000);
      }).catch(error => console.error("Error saving Ad IDs:", error));
    }

    function showResetSuccess(message) {
        resetSuccessMsg.textContent = message;
        resetSuccessMsg.style.display = 'block';
        setTimeout(() => resetSuccessMsg.style.display = 'none', 3000);
    }

    // Reset all balances
    function resetAllBalances() {
      if (confirm('Are you sure you want to reset ALL user balances to zero? This cannot be undone.')) {
        database.ref('users').once('value', (snapshot) => {
          const updates = {};
          snapshot.forEach(childSnapshot => {
            updates[childSnapshot.key + '/points'] = 0;
          });
          database.ref('users').update(updates);
          database.ref('stats/totalPointsEarned').set(0);
          showResetSuccess('All user balances have been reset to 0.00');
        });
      }
    }

    // Reset all ad counts
    function resetAllAdCounts() {
      if (confirm('Are you sure you want to reset ALL ad counts to zero? This cannot be undone.')) {
         database.ref('users').once('value', (snapshot) => {
          const updates = {};
          snapshot.forEach(childSnapshot => {
            updates[childSnapshot.key + '/watched'] = 0;
          });
          database.ref('users').update(updates);
          database.ref('stats/totalAdsWatched').set(0);
          showResetSuccess('All ad counts have been reset to 0');
        });
      }
    }

    // Event listeners
    saveAdIdsBtn.addEventListener('click', saveAdIds);
    resetBalancesBtn.addEventListener('click', resetAllBalances);
    resetAdCountsBtn.addEventListener('click', resetAllAdCounts);

    // Initialize
    loadAdIds();
    loadStats();
  </script>
</body>
</html>
